<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Instrumental Variables</title>
    <meta charset="utf-8" />
    <meta name="author" content="David D. Liebowitz" />
    <script src="EDLD_650_6_IV_2_files/header-attrs-2.20/header-attrs.js"></script>
    <link href="EDLD_650_6_IV_2_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="EDLD_650_6_IV_2_files/remark-css-0.0.1/rladies.css" rel="stylesheet" />
    <link href="EDLD_650_6_IV_2_files/remark-css-0.0.1/ki-fonts.css" rel="stylesheet" />
    <script src="EDLD_650_6_IV_2_files/htmlwidgets-1.6.1/htmlwidgets.js"></script>
    <link href="EDLD_650_6_IV_2_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="EDLD_650_6_IV_2_files/datatables-binding-0.27/datatables.js"></script>
    <script src="EDLD_650_6_IV_2_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="EDLD_650_6_IV_2_files/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="EDLD_650_6_IV_2_files/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="EDLD_650_6_IV_2_files/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
    <link href="EDLD_650_6_IV_2_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="EDLD_650_6_IV_2_files/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <script src="EDLD_650_6_IV_2_files/kePrint-0.0.1/kePrint.js"></script>
    <link href="EDLD_650_6_IV_2_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="my_custom.css" type="text/css" />
    <link rel="stylesheet" href="xaringanthemer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Instrumental Variables
]
.subtitle[
## EDLD 650: Week 6
]
.author[
### David D. Liebowitz
]

---


&lt;style type="text/css"&gt;
.inverse {
  background-color : #2293bf;
}
&lt;/style&gt;



# Agenda

#### 1. Roadmap and goals (9:00-9:10)
#### 2. Discussion Questions (9:10-10:20)
  - Murnane and Willett
  - Angrist et al. (x2)
  - Dee &amp; Penner
  - Dee
  
#### 3. Break (10:20-10:30)
#### 4. Applied instrumental variables (10:30-11:40)
#### 5. Wrap-up (11:40-11:50)
  - DARE #3 prep
  - Plus/deltas

---
# Roadmap

&lt;img src="causal_id.jpg" width="1707" style="display: block; margin: auto;" /&gt;


---
# Goals

### 1. Describe conceptual approach to instrumental variables (IV) analysis

### 2. Assess validity of IV assumptions in applied context

### 3. Conduct IV analysis in simplified data and interpret results

---
class: middle, inverse
# So random...

---
class: middle, inverse

# Break

---
# The PACES experiment

.pull-left[
- Recall the PACES school voucher experiment ([Angrist et al. 2002](https://www.aeaweb.org/articles?id=10.1257/000282802762024629)) from *Methods Matter*, Chapter 11
- Lottery assignment for vouchers to attend private school in Colombia
- What is the .blue[**main outcome**]? 
- What is the .blue[**endogenous regressor**]?
]

.pull.right[
&lt;img src="PACES.jpg" width="321" style="display: block; margin: auto;" /&gt;
]

--
.red-pink[**Parameter of interest**]: *effect of using financial aid to attend private school*

---
# Let's replicate!


```r
paces &lt;- read.csv(here("./data/ch11_PACES.csv"))
DT::datatable(paces[,c(1:7)], fillContainer = FALSE, options = 
                list(pageLength = 5))
```

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-75cc2831be38f1834dfb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-75cc2831be38f1834dfb">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000","1001","1002","1003","1004","1005","1006","1007","1008","1009","1010","1011","1012","1013","1014","1015","1016","1017","1018","1019","1020","1021","1022","1023","1024","1025","1026","1027","1028","1029","1030","1031","1032","1033","1034","1035","1036","1037","1038","1039","1040","1041","1042","1043","1044","1045","1046","1047","1048","1049","1050","1051","1052","1053","1054","1055","1056","1057","1058","1059","1060","1061","1062","1063","1064","1065","1066","1067","1068","1069","1070","1071","1072","1073","1074","1075","1076","1077","1078","1079","1080","1081","1082","1083","1084","1085","1086","1087","1088","1089","1090","1091","1092","1093","1094","1095","1096","1097","1098","1099","1100","1101","1102","1103","1104","1105","1106","1107","1108","1109","1110","1111","1112","1113","1114","1115","1116","1117","1118","1119","1120","1121","1122","1123","1124","1125","1126","1127","1128","1129","1130","1131","1132","1133","1134","1135","1136","1137","1138","1139","1140","1141","1142","1143","1144","1145","1146","1147","1148","1149","1150","1151","1152","1153","1154","1155","1156","1157","1158","1159","1160","1161","1162","1163","1164","1165","1166","1167","1168","1169","1170","1171"],[3,4,5,6,10,11,12,15,16,17,21,22,24,25,27,28,39,41,42,46,48,52,55,58,60,63,64,73,74,75,76,77,80,82,86,87,88,89,91,93,95,97,98,100,103,105,107,110,112,113,115,117,118,119,120,121,123,128,131,134,136,140,141,144,149,153,156,157,158,160,165,168,173,176,177,183,185,186,187,192,193,196,198,199,201,204,205,207,209,211,212,213,214,216,218,220,223,224,226,228,229,230,231,234,236,237,238,239,241,242,243,244,245,250,251,252,254,256,257,258,261,262,263,264,266,267,269,273,276,279,282,285,286,287,288,289,290,293,298,299,300,301,302,304,305,308,309,310,316,317,318,321,323,324,327,329,334,337,339,341,342,344,347,349,350,353,354,359,362,366,367,368,370,371,373,374,375,378,380,381,383,384,385,386,389,390,391,392,394,395,399,400,401,403,404,405,406,410,411,414,416,422,424,425,427,430,434,435,437,439,441,442,445,447,452,453,454,455,456,459,460,461,463,466,468,469,472,475,476,477,478,483,485,486,487,489,490,492,494,497,499,500,501,503,504,506,507,508,511,513,515,520,524,525,526,527,528,532,533,539,540,541,543,544,545,551,552,554,556,557,559,561,563,564,565,567,574,575,580,583,586,593,594,595,596,600,602,604,605,607,608,611,614,618,619,622,623,625,626,632,637,640,641,642,646,647,651,652,654,656,657,658,660,661,664,666,667,668,671,672,673,677,680,682,684,688,690,691,694,698,699,701,702,705,707,708,710,712,718,720,724,729,733,734,736,740,745,746,747,748,749,750,752,754,755,758,759,760,765,768,770,771,772,773,774,775,780,782,783,784,785,786,789,793,794,795,796,797,800,804,806,808,809,813,815,816,820,822,824,829,837,839,840,842,843,849,850,853,854,855,856,857,858,859,865,866,870,872,875,884,888,891,895,896,898,900,901,902,906,909,912,914,915,920,921,923,924,926,928,930,935,936,939,941,947,953,954,955,959,962,963,966,968,969,975,981,983,984,988,989,992,993,996,997,998,1000,1003,1007,1009,1010,1011,1013,1014,1015,1017,1018,1019,1024,1026,1027,1031,1032,1034,1035,1036,1038,1040,1041,1045,1047,1049,1050,1051,1054,1055,1056,1059,1064,1065,1066,1069,1070,1073,1078,1079,1080,1083,1084,1085,1086,1087,1091,1092,1093,1094,1096,1097,1099,1100,1103,1104,1107,1108,1109,1113,1116,1117,1118,1120,1122,1127,1129,1131,1132,1134,1135,1139,1142,1147,1148,1150,1152,1153,1154,1158,1163,1165,1166,1168,1173,1177,1179,1183,1184,1185,1189,1193,1194,1198,1199,1200,1201,1204,1208,1209,1210,1211,1213,1214,1218,1223,1226,1227,1228,1235,1237,1238,1239,1240,1244,1247,1248,1250,1252,1255,1261,1263,1264,1267,1268,1271,1274,1277,1278,1279,1280,1283,1287,1289,1291,1295,1296,1298,1299,1304,1308,1309,1310,1311,1312,1313,1316,1320,1322,1325,1328,1329,1334,1336,1337,1338,1339,1341,1343,1344,1349,1352,1354,1358,1360,1364,1365,1366,1369,1370,1371,1372,1373,1375,1376,1377,1378,1379,1380,1381,1382,1383,1388,1390,1391,1392,1393,1394,1395,1397,1399,1400,1401,1402,1405,1406,1409,1412,1413,1418,1420,1422,1423,1424,1425,1429,1431,1432,1433,1434,1435,1437,1441,1442,1443,1453,1459,1460,1461,1462,1463,1465,1466,1467,1470,1473,1474,1477,1478,1479,1481,1483,1486,1488,1492,1493,1495,1496,1500,1501,1504,1507,1508,1510,1511,1512,1515,1517,1518,1520,1522,1523,1524,1530,1535,1536,1539,1540,1545,1546,1547,1548,1552,1554,1559,1560,1561,1562,1563,1567,1568,1571,1574,1576,1579,1580,1584,1586,1587,1590,1591,1596,1599,1600,1601,1604,1605,1607,1608,1611,1613,1614,1615,1617,1618,1619,1621,1622,1623,1624,1625,1628,1629,1632,1633,1637,1639,1642,1645,1650,1652,1653,1654,1658,1661,1663,1664,1666,1668,1673,1675,1678,1680,1685,1688,1689,1690,1695,1697,1702,1703,1704,1707,1708,1713,1714,1715,1716,1717,1719,1720,1722,1727,1728,1733,1734,1735,1736,1738,1740,1742,1744,1747,1750,1751,1756,1757,1758,1759,1761,1766,1769,1774,1778,1780,1781,1782,1788,1793,1795,1801,1806,1835,1836,1840,1842,1856,1862,1864,1870,1871,1878,1885,1886,1888,1894,1899,1900,1901,1906,1909,1910,1912,1914,1915,1917,1918,1919,1920,1922,1926,1933,1935,1936,1937,1940,1941,1945,1951,1955,1958,1960,1961,1962,1968,1970,1971,1972,1973,1974,1976,1979,1982,1983,1985,1990,1998,1999,2000,2002,2003,2004,2006,2009,2011,2012,2015,2016,2019,2021,2022,2024,2027,2031,2032,2033,2035,2039,2043,2044,2045,2047,2048,2049,2051,2054,2055,2056,2057,2058,2060,2064,2067,2068,2070,2071,2072,2073,2074,2077,2078,2079,2081,2084,2089,2091,2093,2094,2096,2097,2098,2101,2105,2108,2112,2113,2116,2119,2122,2123,2126,2133,2134,2135,2140,2150,2153,2157,2161,2168,2173,2176,2178,2179,2180,2183,2184,2185,2190,2193,2195,2201,2203,2208,2214,2217,2219,2222,2229,2230,2231,2233,2234,2237,2238,2239,2240,2246,2255,2263,2272,2273,2280,2283,2285,2295,2301,2304,2307,2314,2323,2324,2332,2335,2337,2338,2347,2348,2351,2361,2362,2377,2382,2385,2386,2387,2397,2398,2399,2403,2407,2416,2418,2422,2432,2433,2437,2438,2440,2441,2445,2452,2455,2456,2458,2460,2461,2465,2470,2472,2473,2474,2478,2481,2484,2493,2497,2503,2508,2510,2512,2515,2520,2522,2526,2534,2535,2536,2541,2543,2544,2553,2556,2559,2560,2561,2564,2567,2570,2571,2585,2588,2590,2597,2601,2603,2608,2612,2622,2636,2639,2642,2650,2664,2667,2671,2679,2690,2695,2702,2708,2711,2714,2720,2729,2730,2732,2734,2752,2761,2766,2779,2785,2786,2794,2818,2821,2828,2834,2837,2840,2860,2870,2884,2887,2888,2893,2914,2917,2918,2921,2923,2933,2938,2944,2973,2984,3010,3045,3055,3075,3077,3117,3142,3147,3156,3165,3203,3247,3272,3300,3303,3347,3373,3432,3438,3459,3558,3567,3581,3585,3586,3597,3649,3682,3683,3758,3776,3781,3793,3813,3819,3820,3824,3838,3860,3867,3891,3897,3902,3945,3997,4006,4022,4023,4030],[1,0,0,0,1,1,0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,1,1,0,1,1,1,0,1,1,1,0,1,0,0,0,0,0,1,1,1,0,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,0,0,0,1,0,1,0,0,0,0,1,1,0,1,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,1,0,0,1,0,1,1,1,0,1,0,1,0,0,1,1,1,1,1,1,1,1,0,0,1,0,0,0,1,1,0,1,1,0,1,1,0,1,0,1,0,1,0,1,0,1,1,0,0,1,1,0,1,1,0,0,0,1,0,1,0,1,0,0,1,0,1,1,0,0,1,1,0,0,1,0,0,0,0,0,1,0,1,1,1,0,1,0,0,1,0,0,1,0,1,1,0,1,0,1,1,1,0,0,0,1,1,0,1,0,1,0,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,0,0,0,1,1,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,0,0,1,0,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,1,1,0,0,1,0,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,1,0,0,1,1,0,0,0,1,0,1,0,1,0,0,0,0,1,0,1,1,0,0,0,1,0,0,0,0,1,1,1,0,0,0,1,0,0,0,1,0,1,0,0,0,1,1,1,1,0,0,1,1,1,0,0,1,0,0,1,1,1,1,1,1,0,1,1,1,0,0,1,0,1,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,1,0,1,1,1,0,1,1,0,1,1,0,0,1,0,0,1,1,1,0,1,1,0,1,1,1,0,0,1,0,0,0,0,1,0,0,1,0,1,1,1,1,0,1,1,0,1,1,1,1,0,1,0,1,1,0,1,1,0,1,1,0,1,0,1,0,0,0,1,0,1,1,0,1,1,1,0,0,1,1,0,1,1,1,1,1,1,0,0,0,1,1,0,0,0,1,0,0,1,1,0,0,1,1,0,1,1,0,1,0,0,1,0,1,1,1,1,1,0,1,0,0,0,0,1,0,1,0,0,1,1,0,1,1,1,0,0,1,0,1,1,1,1,1,1,1,0,1,1,0,0,1,1,1,0,1,1,1,1,0,0,1,0,1,1,1,0,1,0,0,0,0,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,0,0,0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,1,1,1,0,0,1,1,1,1,1,1,1,0,0,1,1,1,0,0,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,0,1,0,0,0,0,0,1,0,0,1,1,1,1,1,1,0,1,1,1,1,0,1,1,0,1,1,1,0,1,0,1,0,1,0,1,0,1,1,0,1,1,1,1,1,1,0,0,1,0,0,1,1,1,1,0,1,1,0,1,1,1,1,0,1,1,0,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,0,1,0,1,1,1,1,1,0,1,1,0,0,0,1,0,1,1,1,0,1,1,1,0,1,0,1,0,0,1,1,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,1,0,0,0,1,0,1,1,1,1,0,1,0,0,1,0,0,0,0,1,1,1,0,1,0,1,0,1,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,1,1,0,1,1,0,1,1,0,0,0,1,0,0,0,0,1,1,0,0,1,1,0,0,0,1,1,1,0,0,1,1,1,1,0,1,0,1,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,1,0,0,1,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,0,0,0,0,1,1,1,0,0,0,1,0,1,0,1,1,1,1,0,0,1,0,1,1,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,1,0,1,0,1,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,0,1,1,0,0,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[0,1,1,0,1,0,0,0,1,0,1,0,1,0,0,1,0,0,0,1,1,1,1,0,0,0,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,0,0,0,1,0,1,0,0,1,0,1,1,1,1,1,1,0,0,0,1,0,1,0,1,0,1,1,0,0,0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,0,0,1,1,0,1,1,1,0,0,0,0,1,1,1,0,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,1,1,0,1,0,0,1,1,1,0,1,0,1,1,1,0,0,1,0,1,1,1,1,1,1,0,1,0,1,1,0,0,1,1,1,0,1,1,0,0,1,0,0,0,1,0,1,1,1,1,1,0,0,0,1,0,1,0,0,1,1,0,1,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,1,1,0,0,0,1,1,1,1,1,1,0,1,1,0,0,1,0,1,1,1,1,1,0,1,1,1,0,1,1,0,1,0,0,0,1,1,0,1,1,1,1,0,0,1,1,0,0,0,1,1,0,0,0,0,1,0,1,0,0,1,1,1,0,1,0,0,0,1,0,0,1,1,0,1,1,0,1,0,1,1,0,1,0,0,0,0,1,0,0,0,0,1,1,1,1,0,0,1,1,1,1,0,1,1,0,1,0,0,0,0,0,1,0,0,0,0,1,0,1,1,1,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,1,0,0,1,1,0,1,1,1,1,0,0,0,0,1,0,0,1,1,0,0,0,1,0,0,1,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,1,0,1,1,0,0,0,1,1,0,1,1,0,1,0,0,0,0,0,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,1,0,1,1,1,1,1,0,0,1,0,1,0,1,0,1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,1,0,1,1,0,1,1,1,0,1,0,0,1,0,0,1,1,0,0,0,0,0,0,0,1,0,0,1,1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,1,1,1,0,1,0,1,0,0,1,1,1,1,1,1,0,1,1,0,0,1,1,1,1,1,1,1,0,1,1,0,0,0,1,1,0,0,1,1,0,0,0,0,1,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,0,1,0,0,0,0,1,0,0,0,1,0,0,1,1,0,0,0,0,0,1,1,1,1,1,0,0,1,0,1,1,0,1,1,1,1,0,0,1,1,1,1,1,1,1,0,1,0,0,1,0,1,0,0,1,0,1,1,1,0,0,1,0,0,0,0,1,0,0,0,1,1,0,0,1,1,1,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,1,0,0,1,1,1,0,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,1,1,0,1,1,0,1,1,0,1,0,0,1,0,0,1,1,1,0,1,0,0,0,1,0,1,1,1,0,0,0,0,1,0,1,0,0,1,0,1,0,1,0,1,1,0,0,1,0,0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,0,0,1,0,1,0,1,0,1,1,1,1,1,1,1,1,0,0,1,1,0,0,0,0,1,1,1,0,1,1,0,0,0,1,0,0,0,0,1,0,0,1,1,1,1,1,1,1,0,0,1,0,0,1,1,1,1,0,1,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1,1,0,1,1,0,0,0,1,1,0,1,0,1,0,0,0,0,0,1,1,0,1,0,0,1,1,1,0,1,0,1,0,1,1,0,1,0,0,0,1,0,1,0,0,0,1,1,1,1,1,0,0,0,1,1,0,1,0,1,0,0,0,1,1,0,0,0,0,1,0,1,0,0,1,1,0,0,1,1,0,1,1,1,0,1,0,1,1,1,1,0,1,0,0,0,1,1,0,0,1,1,1,1,1,0,0,0,1,1,1,0,1,1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0,1,0,1,1,1,1,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,0,1,1,1,0,1,0,0,1,1,0,0,1,0,0,0,0,0,0,1,1,0,0,1,1,0,1,1,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,0,1,0,1,0,1,0,1,1,1,0,1,1,0,0,1,1,1,0,1,1,0,1,1,1,1,1,0,0,1,0,1,1,1,0,1,0,0,0,1,1,1,1,0,1,1,0,1,0,1,0,1,0,0,1,0,0,1,1,0,0,1,0,1,1,1,0,1,0,1,0,0,0,1,1,1,0,1,0,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0,1,1,0,0,0,0,1,1,0,1,0,1,1,0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,0,1],[11,11,11,9,11,11,11,12,12,14,11,10,12,14,14,14,11,14,13,10,10,13,15,10,11,13,12,11,10,11,14,15,11,12,13,14,13,13,14,10,15,10,10,11,15,13,13,12,13,11,13,11,13,13,11,15,11,11,14,13,13,11,13,12,11,12,12,11,10,15,12,11,11,11,10,13,15,11,11,11,12,14,11,11,12,10,12,11,15,14,12,12,11,10,11,11,12,15,13,13,11,11,13,11,10,13,10,12,13,10,12,11,15,11,14,12,11,14,12,12,12,11,13,11,11,12,11,12,12,11,12,12,12,9,10,11,13,11,11,13,11,12,10,11,12,10,11,13,14,12,11,15,11,12,13,12,11,11,13,12,11,13,12,14,11,10,11,12,10,11,13,14,12,11,11,11,12,12,13,10,12,11,12,13,13,13,11,12,10,11,11,13,12,13,11,11,13,12,16,12,12,13,11,11,12,12,12,11,11,11,11,12,12,14,11,10,11,12,12,11,12,12,10,13,10,14,9,14,15,11,12,14,12,11,14,12,13,15,11,13,13,11,11,12,10,16,14,7,12,11,14,11,11,11,10,13,13,13,12,11,11,11,12,14,11,11,13,12,11,11,15,15,11,13,11,11,15,11,11,13,14,13,12,14,11,12,14,13,12,13,11,12,11,11,10,11,12,12,13,10,15,11,11,12,11,14,12,14,13,11,14,14,15,13,11,13,12,11,12,11,11,11,13,14,11,13,11,12,11,11,11,11,12,10,13,11,14,11,12,14,11,14,13,12,11,10,14,13,10,11,11,12,11,12,10,10,16,13,14,11,11,13,14,12,11,12,12,10,13,10,14,13,14,12,11,11,12,11,11,13,12,12,11,12,14,10,11,10,11,10,11,11,13,12,12,11,12,11,12,12,10,11,13,12,12,12,11,10,11,11,11,11,11,11,12,13,13,11,16,11,12,11,11,15,13,12,11,11,13,11,14,14,11,11,11,12,11,9,14,12,10,12,10,13,13,11,12,10,11,11,10,14,11,11,13,12,12,11,11,14,12,12,12,11,13,11,11,12,11,11,11,11,11,11,14,12,14,13,9,13,12,13,12,11,11,12,11,13,12,11,13,12,12,11,12,14,10,10,14,12,14,14,10,14,11,10,10,12,12,13,11,11,13,11,12,12,12,11,14,11,12,11,11,11,10,11,15,10,11,12,12,11,11,12,13,10,11,13,14,14,10,13,11,10,12,15,13,9,11,10,10,13,14,10,12,11,10,14,11,11,11,12,12,14,11,11,12,12,13,11,12,11,14,14,11,12,11,12,11,11,11,11,11,12,11,12,11,12,14,11,15,11,14,12,15,11,15,12,12,11,14,13,12,13,12,11,13,13,13,11,11,10,10,12,15,13,12,11,11,14,13,12,12,12,11,10,12,11,10,11,12,11,12,13,14,12,12,11,11,15,12,11,10,12,15,11,15,13,12,14,13,13,14,11,11,14,16,11,11,14,11,11,13,11,10,13,13,11,13,10,9,13,14,12,13,11,14,12,11,12,12,12,14,11,10,11,14,12,13,12,15,11,11,11,12,12,11,11,11,11,13,13,15,13,11,11,11,11,12,11,14,12,12,11,12,11,12,11,11,12,11,12,10,12,12,14,11,12,17,15,12,13,13,12,13,12,13,13,11,12,11,11,13,14,13,11,13,11,13,12,12,11,15,12,11,12,11,12,11,12,11,14,13,11,10,11,11,14,11,12,12,12,13,12,12,11,12,11,11,13,12,13,15,13,11,12,12,11,11,10,14,12,10,11,14,12,11,11,11,11,14,12,14,12,13,12,11,12,13,14,10,11,12,13,13,14,11,14,11,11,10,10,13,12,10,11,12,13,11,11,13,15,13,11,12,14,11,12,13,12,13,12,14,11,12,14,10,15,12,12,11,13,14,12,12,14,11,12,12,12,11,11,11,12,12,13,11,11,12,10,11,12,12,12,13,11,11,11,11,11,14,12,11,11,13,11,11,11,12,12,11,11,12,11,14,13,11,12,14,10,12,12,11,13,11,11,15,11,13,15,13,12,11,14,11,14,11,14,11,14,12,11,13,11,13,12,13,9,13,11,10,14,11,12,12,13,11,12,11,12,12,11,11,12,14,14,11,13,13,12,11,12,12,12,12,14,11,12,13,12,14,12,11,13,12,12,14,13,12,13,11,13,14,11,13,13,11,15,12,12,14,11,11,13,10,13,11,12,11,12,12,11,14,11,11,14,12,11,14,15,12,11,12,12,11,12,12,11,13,16,11,11,11,13,12,11,11,13,12,12,11,10,11,11,11,10,14,15,11,11,11,14,14,13,14,11,11,12,11,12,13,12,12,14,12,11,13,13,14,11,14,11,12,13,12,13,11,14,14,12,12,11,11,13,11,13,15,12,11,13,12,10,11,12,11,14,12,13,12,12,9,11,15,13,14,12,13,11,13,11,11,11,12,14,10,12,11,13,13,13,11,13,12,10,12,11,13,14,15,11,10,12,12,10,10,13,11,11,13,12,11,14,12,12,12,15,14,13,11,13,13,12,11,12,15,12,11,12,12,11,10,12,12,15,13,13,14,10,12,11,13,13,12,15,12,10,15,11,11,12,11,12,11,12,14,15,13,11,13,13,11],[1,1,1,0,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,0,0,1,0,1,1,0,1,0,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,0,1,1,0,0,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,0,1,0,0,0,0,0,1,1,0,1,0,1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0,1,0,1,1,1,0,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,1,0,1,1,0,0,1,1,1,1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,1,0,1,1,0,1,1,1,1,1,1,0,1,0,1,1,0,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,0,1,1,1,0,0,1,1,1,1,1,0,1,1,0,1,1,1,0,1,0,1,1,0,0,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,1,0,0,1,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,0,0,1,1,1,0,0,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,1,1,1,1,0,1,0,1,0,0,1,0,1,0,1,0,0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,1,1,0,0,1,0,1,1,0,1,0,1,0,1,1,1,1,1,0,0,1,0,0,0,1,0,1,1,0,1,0,1,1,1,0,0,1,0,0,0,0,0,1,1,1,0,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,0,1,1,0,1,1,0,1,1,1,1,1,1,0,0,1,0,0,1,1,0,0,0,0,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,0,1,1,0,1,0,0,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0,1,1,1,1,0,1,0,1,0,1,1,1,1,1,0,1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,0,1,0,1,0,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,0,0,0,1,1,1,0,0,1,1,0,1,1,1,0,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,1,0,1,0,0,1,0,1,1,1,0,1,0,1,0,1,1,1,1,1,0,1,0,0,0,0,1,1,0,1,1,0,1,0,1,1,1,1,0,1,0,1,0,0,1,1,0,1,0,0,0,1,0,1,0,0,1,1,0,0,1,1,1,0,1,1,1,0,1,1,1,1,1,1,0,1,1,0,1,1,0,0,0,1,1,1,1,1,0,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,1,1,1,0,1,0,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,1,1,0,1,1,0,1,1,1,0,0,1,1,1,0,0,1,1,1,1,0,1,1,1,0,0,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,1,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,1,0,0,1,1,1,0,0,1,0,1,0,1,0,1,1,1,0,0,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,1,0,0,1,1,0,0,0,0,1,1,0,1,1,0,1,1,1,1,0,1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,1,1,1,0,1,1,1,1,0,1,1,1,0,1,0,0,0,0,0,1,1,0,1,1,1,0,1,0,1,0,1,1,1,1,1,0,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,0,0,0,0,0,1,0,1,0,0,1,0,0,0,1,1,1,1,1,1,1,1,0,0,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,1,1,0,0,1,0,1,0,0,1,1,1,1,0,1,0,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,0,0,1,1,0,1,1,1,1],[1,1,0,0,1,1,0,1,0,1,1,1,1,1,0,0,1,0,0,1,1,1,1,1,1,0,0,1,1,0,1,1,1,0,1,1,1,0,1,1,0,0,0,0,0,1,1,0,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,0,0,1,0,0,1,0,1,0,0,0,1,0,0,0,0,0,1,1,1,1,1,0,1,0,0,1,0,0,1,1,0,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,1,0,1,0,1,1,1,0,0,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1,1,0,1,0,1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,1,0,1,0,1,1,1,1,1,0,0,1,1,0,0,1,0,0,0,0,1,1,1,1,1,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,0,0,0,1,0,1,1,1,0,0,1,1,1,0,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,0,1,1,1,0,1,1,0,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,0,0,0,1,0,1,0,0,1,1,1,0,1,0,1,0,1,1,0,1,1,1,1,1,0,1,0,1,0,1,0,0,0,0,1,0,1,1,0,0,0,1,1,0,0,1,1,1,1,0,1,1,1,0,0,0,1,0,0,0,0,0,1,0,1,1,0,0,1,1,1,0,0,1,1,0,1,1,1,0,1,1,1,1,1,1,0,0,1,0,1,0,0,0,1,1,1,1,1,1,1,0,1,1,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,0,1,0,1,0,1,1,1,1,1,1,0,0,1,0,1,0,1,1,0,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,0,1,1,0,0,1,1,1,1,1,1,1,1,0,0,1,1,0,1,1,1,1,0,1,0,0,0,1,1,0,0,0,1,0,0,0,1,1,0,1,1,0,1,1,0,1,0,0,0,0,1,1,1,1,1,0,1,0,0,0,1,1,0,1,0,0,1,1,0,1,1,1,0,0,0,0,1,1,1,0,1,1,1,0,1,1,0,0,1,1,1,0,1,1,1,1,0,0,1,0,1,1,0,0,1,0,0,0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,0,0,0,0,1,0,0,0,1,0,1,0,0,1,1,1,0,1,1,1,0,0,1,1,1,1,1,1,1,0,0,1,1,1,0,0,1,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0,0,1,1,1,1,1,0,0,1,1,1,1,0,1,1,1,1,0,0,0,1,1,0,0,1,0,1,1,1,1,0,1,1,1,1,1,0,0,0,1,0,0,1,1,1,1,0,1,1,0,1,1,1,0,0,1,1,0,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,1,0,1,1,0,1,0,1,0,0,0,1,0,0,0,1,0,1,1,0,1,0,0,1,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,0,1,1,1,0,1,0,1,0,0,0,0,1,1,0,1,0,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,1,0,0,0,0,1,1,1,0,0,1,0,1,1,0,0,1,1,0,0,1,0,1,1,1,0,1,1,0,1,0,0,1,0,0,0,1,0,0,0,1,0,1,0,0,1,0,0,1,1,0,1,0,0,0,1,0,1,0,1,0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,1,0,0,1,1,1,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,0,1,1,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,0,1,0,1,0,0,0,1,1,0,1,1,1,0,0,1,1,0,0,0,1,1,0,1,1,1,1,0,1,1,1,1,1,0,0,1,1,1,0,0,1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,0,1,0,0,0,1,1,1,0,1,0,1,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,1,1,0,1,1,1,1,0,1,0],[2,2,1,1,5,2,1,2,3,5,2,5,3,2,5,2,1,4,4,4,5,3,1,2,5,4,1,4,3,4,5,1,3,5,4,2,1,4,5,4,5,2,5,5,4,5,4,2,5,1,5,2,4,3,2,1,5,2,2,4,4,5,4,2,4,1,2,1,4,2,5,3,1,3,1,4,2,1,1,2,2,3,1,1,1,2,1,2,5,5,1,5,5,5,2,4,3,3,3,2,4,5,4,3,4,4,4,1,4,5,3,5,5,1,3,3,4,1,2,3,1,2,3,3,1,1,4,1,1,5,2,1,2,4,4,3,3,2,4,4,3,1,1,3,4,4,5,4,1,4,3,2,2,1,4,3,5,1,5,3,3,4,3,4,4,5,4,1,2,2,2,4,4,2,1,5,2,5,1,4,5,5,1,1,3,3,4,1,2,1,1,2,4,5,5,5,4,3,3,5,2,4,4,5,4,2,5,4,5,3,1,5,2,3,2,4,5,2,1,5,1,4,2,5,4,1,3,1,4,2,4,2,2,5,4,3,4,5,1,1,3,4,5,4,5,1,5,4,3,5,2,2,4,1,3,3,4,3,2,4,1,5,2,5,5,4,1,2,4,1,2,3,4,5,5,2,1,5,4,5,2,4,1,2,5,2,3,1,2,5,1,4,4,5,2,2,4,4,5,5,5,1,4,1,2,1,3,5,1,2,3,4,3,1,4,2,5,4,2,4,3,4,4,2,1,4,4,3,2,4,4,4,5,2,4,5,3,1,2,4,3,4,2,2,2,3,4,4,1,5,2,5,1,5,5,1,4,3,4,1,1,2,1,3,2,4,3,3,3,4,1,5,2,2,5,5,4,4,2,4,2,3,5,3,1,3,1,2,5,5,1,2,2,4,3,5,1,3,1,5,1,5,4,2,1,2,4,2,5,1,2,3,1,3,3,1,4,2,3,2,2,5,5,4,5,5,4,2,3,5,3,2,4,3,3,3,1,1,4,1,1,5,3,3,5,1,3,2,1,5,1,2,5,1,5,5,2,3,5,4,4,1,5,3,4,1,4,1,2,4,3,1,3,1,3,4,4,4,4,2,4,3,5,3,3,4,3,4,1,4,1,5,2,1,5,1,1,2,2,3,2,2,1,1,1,4,1,3,2,2,4,2,5,1,3,1,2,1,5,5,4,3,1,4,2,3,4,2,3,4,3,4,5,5,1,2,4,2,3,5,5,2,4,3,4,3,3,2,3,5,4,3,3,3,2,5,3,1,3,4,5,4,1,5,4,3,4,2,4,4,3,4,4,4,2,2,4,5,5,5,3,5,2,5,1,5,2,2,5,2,4,2,2,3,5,1,1,3,4,3,4,2,2,1,2,1,3,2,4,1,5,5,3,1,4,1,2,2,2,3,2,1,5,3,3,2,5,3,1,2,4,2,1,4,3,2,4,4,2,2,1,5,1,4,2,5,2,5,1,5,1,3,5,5,5,3,4,1,4,4,4,3,4,2,1,5,2,2,5,1,4,3,5,2,1,2,1,1,3,4,5,1,5,3,4,3,2,4,5,5,4,4,2,3,3,4,2,5,1,1,3,3,3,5,3,1,2,2,1,3,1,4,2,4,4,5,1,3,1,1,1,3,3,2,2,3,3,1,2,3,3,3,1,4,5,5,1,1,3,3,1,4,3,1,2,4,1,5,4,2,3,5,5,3,3,4,5,5,3,2,3,5,5,3,4,2,5,1,4,2,3,2,5,4,5,3,1,1,2,1,5,2,5,2,3,3,1,2,5,3,3,3,4,1,1,3,1,3,5,3,4,3,2,4,3,1,5,2,5,4,1,5,1,5,5,3,2,4,1,1,3,2,1,4,5,1,2,1,4,1,4,2,1,2,5,4,3,2,3,1,2,3,3,4,1,2,3,1,3,1,5,1,1,3,2,1,4,4,5,4,2,2,3,1,1,4,2,4,5,1,1,4,1,1,2,2,3,5,5,1,5,5,3,3,2,3,3,4,1,3,3,3,1,3,3,4,3,1,5,2,1,5,5,4,5,5,5,2,4,4,3,2,3,1,2,1,2,4,1,4,3,1,5,5,5,2,5,5,2,3,4,1,5,4,2,1,5,4,3,1,4,2,5,1,5,5,3,5,3,5,3,3,5,3,3,2,1,4,5,2,3,1,4,2,2,1,1,1,5,3,1,2,5,5,3,4,1,2,2,5,1,1,2,1,3,5,3,1,3,4,1,3,2,1,2,3,4,3,1,1,1,2,1,1,3,4,5,4,1,4,5,3,3,3,4,3,1,5,5,3,5,3,4,2,4,1,4,4,1,5,4,4,2,5,3,5,5,1,3,2,5,1,2,3,4,2,4,1,1,2,3,5,5,4,2,2,1,4,2,2,3,3,5,2,3,1,1,2,5,3,5,2,5,1,1,2,3,3,5,4,1,2,2,1,1,1,1,5,4,3,2,3,5,5,1,4,3,5,5,4,3,4,3,1,2,4,3,5,4,5,5,5,4,5,3,3,5,1,4,4,1,4,4,3,3,2,1,3,4,3,4,4,1,1,4,1,3,5,1,4,1,5,3,3,4,3,1,2,1,4,4,5,2,5,5,2,1,4,3,2,4,4,4,2,3,3,5,1,5,3,5]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>won_lottry<\/th>\n      <th>male<\/th>\n      <th>base_age<\/th>\n      <th>finish8th<\/th>\n      <th>use_fin_aid<\/th>\n      <th>school<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>

---
## First post-randomization task?

--

&lt;img src="causal_id.jpg" width="1707" style="display: block; margin: auto;" /&gt;

---
# Balance checks

### Examine by covariates:
`$$\bar{X}_{D=1} \approxeq \bar{X}_{D=0}$$`

```r
random &lt;- arsenal::tableby(won_lottry ~ male + base_age, paces)
summary(random)
```



|                            |   0 (N=579)    |   1 (N=592)    | Total (N=1171) | p value|
|:---------------------------|:--------------:|:--------------:|:--------------:|-------:|
|**male**                    |                |                |                |   0.980|
|&amp;nbsp;&amp;nbsp;&amp;nbsp;Mean (SD) | 0.504 (0.500)  | 0.505 (0.500)  | 0.505 (0.500)  |        |
|&amp;nbsp;&amp;nbsp;&amp;nbsp;Range     | 0.000 - 1.000  | 0.000 - 1.000  | 0.000 - 1.000  |        |
|**base_age**                |                |                |                |   0.422|
|&amp;nbsp;&amp;nbsp;&amp;nbsp;Mean (SD) | 12.036 (1.352) | 11.973 (1.343) | 12.004 (1.347) |        |
|&amp;nbsp;&amp;nbsp;&amp;nbsp;Range     | 7.000 - 16.000 | 9.000 - 17.000 | 7.000 - 17.000 |        |

---
# Balance checks

### Omnibus `\(F\)`-test approach:


```r
summary(lm(won_lottry ~ male + base_age, data=paces))
```

```
...
#&gt; Coefficients:
#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)  0.609897   0.131294   4.645 3.78e-06 ***
#&gt; male         0.002568   0.029338   0.088    0.930    
#&gt; base_age    -0.008800   0.010894  -0.808    0.419    
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Residual standard error: 0.5005 on 1168 degrees of freedom
#&gt; Multiple R-squared:  0.000559,	Adjusted R-squared:  -0.001152 
*#&gt; F-statistic: 0.3266 on 2 and 1168 DF,  p-value: 0.7214
...
```

---
## A na&amp;iuml;ve estimate of financial aid


```r
ols1 &lt;- lm(finish8th ~ use_fin_aid, data=paces)
ols2 &lt;- lm(finish8th ~ use_fin_aid + base_age + male, data=paces)
```

.small[

&lt;table style="text-align:center"&gt;&lt;tr&gt;&lt;td colspan="3" style="border-bottom: 1px solid black"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="text-align:left"&gt;&lt;/td&gt;&lt;td&gt;(1)&lt;/td&gt;&lt;td&gt;(2)&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan="3" style="border-bottom: 1px solid black"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="text-align:left"&gt;use_fin_aid&lt;/td&gt;&lt;td&gt;0.133&lt;sup&gt;***&lt;/sup&gt;&lt;/td&gt;&lt;td&gt;0.121&lt;sup&gt;***&lt;/sup&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="text-align:left"&gt;&lt;/td&gt;&lt;td&gt;(0.027)&lt;/td&gt;&lt;td&gt;(0.027)&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="text-align:left"&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="text-align:left"&gt;base_age&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;-0.063&lt;sup&gt;***&lt;/sup&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="text-align:left"&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;(0.010)&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="text-align:left"&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="text-align:left"&gt;male&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;-0.086&lt;sup&gt;**&lt;/sup&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="text-align:left"&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;(0.026)&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="text-align:left"&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan="3" style="border-bottom: 1px solid black"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="text-align:left"&gt;Observations&lt;/td&gt;&lt;td&gt;1,171&lt;/td&gt;&lt;td&gt;1,171&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="text-align:left"&gt;R&lt;sup&gt;2&lt;/sup&gt;&lt;/td&gt;&lt;td&gt;0.020&lt;/td&gt;&lt;td&gt;0.064&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan="3" style="border-bottom: 1px solid black"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="text-align:left"&gt;&lt;em&gt;Note:&lt;/em&gt;&lt;/td&gt;&lt;td colspan="2" style="text-align:left"&gt;&lt;sup&gt;*&lt;/sup&gt;p&lt;0.05; &lt;sup&gt;**&lt;/sup&gt;p&lt;0.01; &lt;sup&gt;***&lt;/sup&gt;p&lt;0.001&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
]

---
## What's wrong with na&amp;iuml;ve approach?

--

&gt; Only about 90 percent of lottery winners used the private school voucher to pay for private school and 24 percent of lotter losers found other sources of scholarships for which to pay for private school. There are endogenous differences in the expected outcomes of children from families who chose to both use the voucher and those who secured scholarship funding from sources outside the voucher lottery. The policy relevant question is how a public subsidy of private school might affect educational attainment for children from low-income families in Bogota, Colombia. The na&amp;iuml;ve approach does not identify these effects but rather the combination of voucher subsidy and endogenous unobservables across families and individuals. 

---
# Some differences


```r
not_random &lt;- arsenal::tableby(use_fin_aid ~ male + base_age, paces)
summary(not_random)
```



|                            |   0 (N=490)    |   1 (N=681)    | Total (N=1171) | p value|
|:---------------------------|:--------------:|:--------------:|:--------------:|-------:|
|**male**                    |                |                |                |   0.428|
|&amp;nbsp;&amp;nbsp;&amp;nbsp;Mean (SD) | 0.518 (0.500)  | 0.495 (0.500)  | 0.505 (0.500)  |        |
|&amp;nbsp;&amp;nbsp;&amp;nbsp;Range     | 0.000 - 1.000  | 0.000 - 1.000  | 0.000 - 1.000  |        |
|**base_age**                |                |                |                |   0.043|
|&amp;nbsp;&amp;nbsp;&amp;nbsp;Mean (SD) | 12.098 (1.389) | 11.937 (1.313) | 12.004 (1.347) |        |
|&amp;nbsp;&amp;nbsp;&amp;nbsp;Range     | 7.000 - 17.000 | 9.000 - 16.000 | 7.000 - 17.000 |        |
---
# How could IV address?


&lt;img src="iv2.jpg" width="1707" style="display: block; margin: auto;" /&gt;

--

.pull-left[
**IV estimate**: ratio of area of *overlap of `\(Y\)` and `\(Z\)`* to area of *overlap of `\(D\)` and `\(Z\)`*. Depends entirely on variation in `\(Z\)` that predicts variation in `\(Y\)` and `\(D\)`:
]

.pull-right[
`$$\hat{\beta}_{1}^{IVE} = \frac{S_{YD}}{S_{DZ}}$$`
a .blue[**Local Average Treatment Effect**]
]

---
# Recall 2SLS set-up

### 1&lt;sup&gt;st&lt;/sup&gt; stage:
Regress the endogenous treatment `\((D_{i})\)` on instrumental variable `\((Z_{i})\)`:
`$$D_{i} = \alpha_{0} + \alpha_{1}Z_{i} + \nu_{i}$$`

Obtain the *predicted values* of the treatment `\((\hat{D_{i}})\)` from this fit.

--

### 2&lt;sup&gt;nd&lt;/sup&gt; stage:
Regress the outcome `\((Y_{i})\)` on the predicted values of the treatment `\((\hat{D_{i}})\)`:
`$$Y_{i} = \beta_{0} + \beta_{1}\hat{D_{i}} + \varepsilon_{i}$$`

--

.blue[Think about this in the Colombia PACES experiment context. What is the **main outcome**? What is the **endogenous regressor**? What is the **instrument**? Can you write the two-stage equation without consulting the next slide or book?]

---
# The PACES Scholarship

### 1&lt;sup&gt;st&lt;/sup&gt; stage:
$$
`\begin{align}
  USEFINAID_{i}=\alpha_{0} + \alpha_{1} WONLOTTERY_{i} + \nu_{i}
\end{align}`
$$

--


### 2&lt;sup&gt;nd&lt;/sup&gt; stage:
$$
`\begin{align}
  FINISH8TH_{i}=\beta_{0} + \beta_1 \hat{USEFINAID}_{i} + \varepsilon_{i}
\end{align}`
$$

--

.blue[What is the main outcome? What is the endogenous regressor? What is the instrument? What are the assumptions?]


---
# Outcome by lottery status
&lt;img src="EDLD_650_6_IV_2_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /&gt;

--

This represents an important substantive finding... .blue[**can you interpret what it is?**]

---
# A simple `\(t\)`-test


```r
ttest &lt;- t.test(finish8th ~ won_lottry, data=paces)
ttest
```

```
#&gt; 
#&gt; 	Welch Two Sample t-test
#&gt; 
#&gt; data:  finish8th by won_lottry
*#&gt; t = -4.1077, df = 1153.5, p-value = 4.279e-05
#&gt; alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -0.16441869 -0.05812251
#&gt; sample estimates:
*#&gt; mean in group 0 mean in group 1 
*#&gt;       0.6252159       0.7364865
```

--


.blue[**Can you interpret what this means?**]

---
# Intent-to-Treat Estimates


```r
itt1 &lt;- lm(finish8th ~ won_lottry, data=paces)
itt2 &lt;- lm(finish8th ~ won_lottry + base_age + male, data=paces)
itt3 &lt;- lm(finish8th ~ won_lottry + base_age + male + 
             as.factor(school), data=paces)
```
.small[
&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
&lt;caption&gt;Table 1. Intent-to-Treat Estimates of Winning the PACES lottery on 8th Grade Completion&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;  (1) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (2) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (3) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Won Lottery &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.111*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.107*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.108*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.027) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.026) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.027) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Starting Age &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.065*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.064*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.010) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.010) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.088*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.089*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.027) &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.027) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; School Fixed Effects &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; RMSE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.46 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; Notes: The table displays coefficients from Equation X and standard errors in parentheses.&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;
&lt;/table&gt;
]

---
# Intent-to-Treat Estimates

### .blue[What is our parameter of interest? Do these estimates represent that?]


.small[
&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
&lt;caption&gt;Table 1. Intent-to-Treat Estimates of Winning the PACES lottery on 8th Grade Completion&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;  (1) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (2) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (3) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Won Lottery &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.111*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.107*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.108*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.027) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.026) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.027) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Starting Age &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.065*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.064*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.010) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.010) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.088*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.089*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.027) &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.027) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; School Fixed Effects &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; RMSE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.46 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; Notes: The table displays coefficients from Equation X and standard errors in parentheses.&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;
&lt;/table&gt;
]

---
## Implementing IV in regression

### Reminder of key assumptions:
1. Instrument correlated with endogenous predictor (.red-pink[no **"weak" instruments**])
2. Instrument not correlated with 1&lt;sup&gt;st&lt;/sup&gt; stage residuals `\((\sigma_{Z\nu} = 0)\)`
3. Instrument not correlated with 2&lt;sup&gt;nd&lt;/sup&gt; stage residuals `\((\sigma_{Z\varepsilon} = 0)\)` and correlated with outcome only via predictor&lt;sup&gt;[1]&lt;/sup&gt;
  + .red-pink[Exclusion restriction means **NO THIRD PATH!**]

--

### Practical considerations:
Can implement this various ways. Pedagogically, we'll implement 2SLS using the `fixest` package because it allows straightforward presentation of 1&lt;/sup&gt;st&lt;/sup&gt; stage results. This can also be done via `ivreg` and `iv_robust` in R.

.footnote[[1] Don't forget, .red-pink[**no defiers**] too.]

---
# IV Estimation


```r
# Instrument with no covariates
# With only instrumented predictor and no covariates, 
# need to include a "1" in 2nd stage
tot1 &lt;- feols(finish8th ~ 1 | use_fin_aid ~ won_lottry, data=paces)

# Instrument with covariates
# Note that these are automatically included in 1st stage
# Can include multiple instruments and multiple
# endogenous predictors
tot2 &lt;- feols(finish8th ~ base_age + male | 
                          use_fin_aid ~ won_lottry, data=paces)
```

---
# IV results - First Stage

```r
summary(tot2, stage = 1)
```

```
#&gt; TSLS estimation, Dep. Var.: use_fin_aid, Endo.: use_fin_aid, Instr.: won_lottry
#&gt; First stage: Dep. Var.: use_fin_aid
#&gt; Observations: 1,171 
#&gt; Standard-errors: IID 
#&gt;              Estimate Std. Error   t value   Pr(&gt;|t|)    
#&gt; (Intercept)  0.432760   0.095159  4.547738 5.9880e-06 ***
#&gt; won_lottry   0.674527   0.021014 32.098773  &lt; 2.2e-16 ***
#&gt; base_age    -0.015160   0.007826 -1.937178 5.2965e-02 .  
#&gt; male        -0.020257   0.021070 -0.961417 3.3654e-01    
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; RMSE: 0.358813   Adj. R2: 0.469577
*#&gt; F-test (1st stage): stat = 1,030.3, p &lt; 2.2e-16, on 1 and 1,167 DoF.
```

--
.small[
You will see some common rules of thumb about what makes for a strong instrument (e.g., `\(t_{F}&gt;10\)`), but recent work has found that with `\(t\)`-ratios lower than 100 one should adjust critical value ([Lee et al., 2021](https://www.nber.org/papers/w29124)).
]

---
# IV results - Second Stage

```r
summary(tot2)
```

```
#&gt; TSLS estimation, Dep. Var.: finish8th, Endo.: use_fin_aid, Instr.: won_lottry
#&gt; Second stage: Dep. Var.: finish8th
#&gt; Observations: 1,171 
#&gt; Standard-errors: IID 
#&gt;                  Estimate Std. Error  t value   Pr(&gt;|t|)    
#&gt; (Intercept)      1.378128   0.123090 11.19614  &lt; 2.2e-16 ***
#&gt; fit_use_fin_aid  0.159000   0.039173  4.05890 5.2589e-05 ***
#&gt; base_age        -0.062157   0.009872 -6.29603 4.3146e-10 ***
#&gt; male            -0.085145   0.026504 -3.21258 1.3515e-03 ** 
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; RMSE: 0.451177   Adj. R2: 0.059822
#&gt; F-test (1st stage), use_fin_aid: stat = 1,030.3    , p &lt; 2.2e-16 , on 1 and 1,167 DoF.
#&gt;                      Wu-Hausman: stat =     1.78464, p = 0.181841, on 1 and 1,166 DoF.
```

.blue[**Can you interpret what this means?**]

---
# A taxonomy of IV estimates

```r
# Include school fixed effects
tot3 &lt;- feols(finish8th ~ base_age + male | as.factor(school) | 
              use_fin_aid ~ won_lottry, 
              vcov = "iid",  data=paces)

# Cluster-robust standard errors
tot4 &lt;- feols(finish8th ~ base_age + male | as.factor(school) | 
              use_fin_aid ~ won_lottry, 
              vcov = ~ school, data=paces)
```
---
# Estimate voucher use effects
.small[
&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
&lt;caption&gt;Table 2. Instrumental variable estimates of using financial aid to attend private school due to winning the PACES lottery on 8th grade completion&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;  (1) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (2) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (3) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (4) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Use Fin. Aid &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.165*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.159*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.161*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.161* &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.040) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.039) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.039) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.052) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Starting Age &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.062*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.062*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.062** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.010) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.010) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.009) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.085** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.086** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.086 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.027) &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.027) &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.037) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; School FE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; RMSE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.46 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; The table displays coefficients from Equation X and standard errors in parentheses. Model 4 uses cluster-robust standard errors at school level.&lt;/td&gt;&lt;/tr&gt;
&lt;/tfoot&gt;
&lt;/table&gt;
]
 
---
# OLS, ITT and TOT estimates

.small[
&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
&lt;caption&gt;Table 3. Comparison of OLS, ITT and IV estimates of using financial aid to attend private school due to winning the PACES lottery&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;  (1) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (2) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (3) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (4) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   (5) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; OLS &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ITT &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; TOT &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; TOT &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; TOT &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Use Fin. Aid &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.121*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.165*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.159*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.161* &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.027) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.040) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.039) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.052) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Win Lottery &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.107*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.026) &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; School FE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Student Chars. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Clust. SEs &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Yes &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1171 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; RMSE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.46 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.45 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; The table displays coefficients from Equation X and standard errors in parentheses.&lt;/td&gt;&lt;/tr&gt;
&lt;/tfoot&gt;
&lt;/table&gt;
]

---
# Interpretation of results

.small[The na&amp;iuml;ve OLS estimates .large[.red-pink[understate]] the effects of a public voucher subsidy for private school attendance for over 125,000 children from low-income families in Bogota, Colombia. Our preferred estimates of the effect of voucher use on eighth-grade completion imply an increase in the on-time completion rate of 16 percentage points.]

--

.small[The estimates of the endogenous relationship between the use of financial aid to attend private school and school attainment (Model 1) imply that students who use any form of external scholarship are 12 percentage points more likely to complete eighth grade. In Model 2, we present results of winning an unbiased lottery to receive vouchers covering slightly more than half the cost of average private school attendance. We find that the offer of the voucher increased eighth-grade completion rates by just less than 11 percentage points. Finally, Models 3-5 present a taxonomy of Treatment-on-the-Treated estimates in which we use the randomized lottery as an instrument for the use of financial aid to attend private school. We find consistent effects 50 percent larger than the Intent-to-Treat estimates. These models are robust to the inclusion of baseline student characteristics, cohort fixed effects, and the clustering of standard errors at the level of randomization (within school).]

---
class: middle, inverse
# Synthesis and wrap-up

---
# Goals

### 1. Describe conceptual approach to instrumental variables (IV) analysis

### 2. Assess validity of IV assumptions in applied context

### 3. Conduct IV analysis in simplified data and interpret results


---
# Can you explain this figure?

&lt;img src="causal_id.jpg" width="1707" style="display: block; margin: auto;" /&gt;

---
# To-Dos

### Week 7: Instrumental Variables

### Readings: 
- Kim, Capotosto, Hartry &amp; Fitzgerald (2011)

### Assignments Due
**DARE 3**
- Due 11:59pm, Feb. 18



---
# Feedback

## Plus/Deltas

Front side of index card

## Clear/Murky

On back

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
